class MutationObserverRegistry{constructor(e){this.functionsForAnyMutation=[],this.functionsForNodeAddition=[],this.observerName=e}addFunctionForAnyMutation=e=>this.functionsForAnyMutation.push(e);addFunctionForNodeAddition=e=>this.functionsForNodeAddition.push(e);observer=new MutationObserver((e=>{const t=Date.now();for(let t in e){let n=e[t];if(n.addedNodes&&n.addedNodes.length>0){let e=Array.from(n.addedNodes);for(let t in e){let n=e[t];for(let e in this.functionsForNodeAddition){(0,this.functionsForNodeAddition[e])(n,this.observerName)}}}for(let e in this.functionsForAnyMutation){(0,this.functionsForAnyMutation[e])(n,this.observerName)}}const n=Date.now();GLOBAL.totalTimeSpentInRolandUImodsScript+=n-t}))}class ConditionalFormatting{constructor(){this.textMatchStyles=JSON.parse(GLOBAL.settingsManager.settings.textMatchStyles)}run=()=>{GLOBAL.mutationObserverRegistry.addFunctionForAnyMutation(this.processMutation),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.processTextNode),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.accessLinkMod),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.defectRequestMod)};processMutation=(e,t)=>{this.expandEmailInput(e),this.expandT3investigationActionTextInput(e),this.monitorActiveCaseWhenUrlChanges(e),this.listenForAttachedImages(e),this.applyFeedFont(e)};applyFeedFont=e=>{if(GLOBAL.settingsManager.settings.overrideStandardFeedFont){const t=$(e.target),n=GLOBAL.settingsManager.settings.customFeedFont.length>0?GLOBAL.settingsManager.settings.customFeedFont:GLOBAL.settingsManager.settings.feedFontFamily;if("emailuiFrame"==t.attr("id")){$(t.get(0).contentWindow.document).find("body").css({fontFamily:n,fontSize:`${GLOBAL.settingsManager.settings.feedFontSize}px`})}else if(t.hasClass("cuf-compactBody")){let e=t.find(".feedBodyInner");e.length>0&&e.css({fontFamily:n,fontSize:`${GLOBAL.settingsManager.settings.feedFontSize}px`})}else if(t.hasClass("cuf-element")){let e=t.find(".preamble_custom-summary");e.length>0&&e.css({fontFamily:n,fontSize:`${GLOBAL.settingsManager.settings.feedFontSize}px`});let s=t.find(".uiOutputText");s.length>0&&s.css({fontFamily:n,fontSize:`${GLOBAL.settingsManager.settings.feedFontSize}px`})}}};listenForAttachedImages=e=>{const t=$(e.target);if(t.hasClass("forceContentModalPreviewPlayer")){GLOBAL.imageContainerDiv=t.find("div.thumbnail img.pageImg").parent();let e=t.find("div.thumbnail img.pageImg").attr("src"),n=t.find("img.pageImg").attr("src");e&&GLOBAL.attachedImageUrls.push(e),GLOBAL.imageUrlResolvedCallback&&(e||n)&&GLOBAL.imageUrlResolvedCallback(e)}};expandT3investigationActionTextInput=e=>{const t=$(e.target);if(t.hasClass("ql-editor slds-rich-text-area__content slds-text-color_weak slds-grow")){t.css({maxHeight:"10000px"});let e=t.closest(".forceChatterMessageBodyInputRichTextEditor");e.length>0&&e.css({maxHeight:"10000px"})}};expandEmailInput=e=>{const t=$(e.target);if(t.hasClass("uiInput")){const e=t.find("iframe");if(e.length>0){const t="#cke_1_contents",n=$(e[0]).contents().find(t),s=$(e[0]).contents().find("iframe");if(s.length>0){const e=$(s[0]).contents().find("body");e.length>0&&(this.tampermonkeyLinkInQuickText(e),n.height(e.outerHeight()+20),GLOBAL.keyPressedOn=Date.now())}}}};tampermonkeyLinkInQuickText=e=>{let t=e.html();/\&lt;tampermonkeylink\&gt;.*?\&lt;\/tampermonkeylink\&gt;/.test(t)&&(t=t.replace(/\&lt;tampermonkeylink\&gt;/g,'<a href="'),t=t.replace(/\&lt;\/tampermonkeylink\&gt;/g,'">Tampermonkey link</a>'),e.html(t))};tryToFindFileLinks=()=>{console.log("trying to find links");let e=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");e.length>0&&(GLOBAL.fileLinks=e),console.log(e)};monitorActiveCaseWhenUrlChangesOld=()=>{if(window.location.pathname!=GLOBAL.pathname){GLOBAL.pathname=window.location.pathname,GLOBAL.fileLinks=null,console.log("links cleared"),this.tryToFindFileLinks();let e=GLOBAL.pathname.split("/");e.length>3&&"case"==e[e.length-3].toLowerCase()?GLOBAL.activeCaseId=e[e.length-2]:GLOBAL.activeCaseId=null,Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())}};monitorActiveCaseWhenUrlChanges=()=>{if(window.location.pathname!=GLOBAL.pathname){GLOBAL.pathname=window.location.pathname;let e=GLOBAL.pathname.split("/");e.length>4&&"case"==e[3].toLowerCase()?(console.log(GLOBAL.activeCaseId),console.log(e[4]),GLOBAL.activeCaseId!=e[4]&&GLOBAL.activeCaseId&&(GLOBAL.fileLinks=null,console.log("links cleared")),GLOBAL.activeCaseId=e[4]):GLOBAL.activeCaseId=null,Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())}};highlightActiveCase=()=>{if(!GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].highlighted){for(let e in GLOBAL.caseIdNumberPairs)GLOBAL.caseIdNumberPairs[e].highlighted=!1;GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].highlighted=!0,$(".conditional-formatting-highlighted-case").css("background-color",""),$(".conditional-formatting-highlighted-case").removeClass(".conditional-formatting-highlighted-case");let e=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].textNode,t=$(e).closest(".slds-split-view__list-item");if(t.length>0){let e=this.getStyleBasedOnTextArray(this.getTextFromNode(t.get(0))),n=null!=e.bgColor?e.bgColor:"";for(let e in this.textMatchStyles){let t=this.textMatchStyles[e];if(t.text==GLOBAL.activeCaseStatus){n=t.bgColor;break}}t.addClass("conditional-formatting-highlighted-case"),t.css("background-color",n)}}};getStyleBasedOnTextArray=e=>{for(let t in e){let n=e[t];for(let e in this.textMatchStyles){let t=this.textMatchStyles[e];if(t.text==n)return t}}return null};getTextFromNode=e=>{let t,n=[],s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;t=s.nextNode();)n.push(t.textContent);return n};processTextNode=e=>{const t=Date.now();let n,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;n=s.nextNode();)this.clickOnInternalOnly(n),this.color(n),this.gatherCaseIdNumberPairs(n),GLOBAL.settingsManager.settings.allUrlHyperlinkingBeta?this.allUrlHyperlinking(n):this.defectRequestIssueInTableHyperlinking(n),this.findFilesSection(n),this.findEscalatedToT3OrDevWarning(n),this.supportScoreHighlightInPanels(n),this.supportScoreInTableHighlighting(n),this.supportScoreInReportsHighlighting1(n),this.supportScoreInReportsHighlighting2(n),this.closeTheAccessLinkRequestPopup(n),this.changepointIdHyperlinking(n),this.agilePlaceIdHyperlinking(n),this.tasktopJiraIdHyperlinking(n),this.tasktopZendeskIdHyperlinking(n),this.tasktopJiraIdHyperlinkingManyIds(n),this.generalMessageIsNullHighlighting(n),this.milestonesCompleted(n);const i=Date.now();GLOBAL.totalTimeSpent+=i-t};milestonesCompleted=e=>{if("You completed all the milestones."==e.textContent){$(e.parentNode).closest(".supportMilestones").hide()}};generalMessageIsNullHighlighting=e=>{if("General Message"==e.textContent){let t=$(e.parentNode).closest("div.slds-form-element"),n=t.find("span.uiOutputTextArea");n.length>0&&n.text().length>0&&t.css({backgroundColor:"rgb(245, 183, 153)"})}};closeTheAccessLinkRequestPopup=e=>{if("Access Link Request"==e.textContent){let t=$(e.parentNode).closest("div.modal-container").find('button[title="Close this window"]');t.length>0&&t.click()}};displayTimeSpent=()=>{setTimeout((()=>{console.log("Time spent:",GLOBAL.totalTimeSpent),this.displayTimeSpent()}),1e3)};supportScoreHighlightInPanels=e=>{if("Support Score"==e.textContent){let t=$(e.parentNode).closest("div.slds-form-element"),n=t.find("span.uiOutputNumber");this.supportScoreHighlight(t,n.html())}};supportScoreHighlight=(e,t)=>{let n=isNaN(parseFloat(t))?0:parseFloat(t);n>GLOBAL.settingsManager.settings.ssRedThreshold?e.css("background-color","#ea9999"):n>GLOBAL.settingsManager.settings.ssOrangeThreshold?e.css("background-color","#f5b799"):n>GLOBAL.settingsManager.settings.ssYellowThreshold?e.css("background-color","#ffe599"):e.css("background-color","#d9ead3")};findEscalatedToT3OrDevWarning=e=>{if("WARNING!!! This case has already been escalated to Tier 3 or Dev. Do not click save!"==e.textContent){$(e.parentNode).closest("div.uiTabset--base").find('span.title:contains("T3")').closest("li").hide(),$('span.title:contains("Post")').click()}};findFilesSection=e=>{if("Files"==e.textContent){$(e.parentNode).closest(".forceListViewManager").length>0&&this.waitForFileLinks()}};waitForFileLinks=()=>{setTimeout((()=>{let e=$('button[title="Close Files"]');console.log("close button",e),e.length>0&&(GLOBAL.fileTabCloseButton=e);let t=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");t.length>0?(GLOBAL.fileLinks=t,"function"==typeof GLOBAL.imageUrlResolvedCallback&&GLOBAL.imageUrlResolvedCallback(t)):this.waitForFileLinks()}),100)};allUrlHyperlinking=e=>{if(/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:\/~+#-]*[\w@?^=%&\/~+#-])?$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=e.textContent,n=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(t)?t.split("/").pop():t;$(e.parentNode).html(`<a href="${t}" target="_blank">${n}</a>`)}};changepointIdHyperlinking=e=>{if(/^CP(C|E)-20\d{2,2}-\d{5,5}$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=e.textContent,n=`https://desktop.changepointasp.com/core/portlet.aspx?ui=p&portletid=dcrequest&Params=action=edit;reqnum=${t}`;setTimeout((()=>{$(e.parentNode).html(`<a href="${n}" target="_blank">${t}</a>`)}),100)}};agilePlaceIdHyperlinking=e=>{if(/^planview\.leankit\.com\/card\/\d{10}$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=e.textContent.split("/").reverse()[0],n=`https://${e.textContent}`;setTimeout((()=>{$(e.parentNode).html(`<a href="${n}" target="_blank">${t}</a>`)}),100)}};tasktopZendeskIdHyperlinking=e=>{if(/^TT-\d\d*\d$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=`https://tasktopsupport.zendesk.com/agent/tickets/${e.textContent.split("-")[1]}`;setTimeout((()=>{$(e.parentNode).html(`<a href="${t}" target="_blank">${e.textContent}</a>`)}),100)}};tasktopJiraIdHyperlinking=e=>{if(/^(VIZ|APPS|CON|viz|con|apps)\-\d*$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=e.textContent,n=`https://tasktop${window.location.href.includes("planview.lightning")?"":"-sandbox"}.atlassian.net/browse/${t}`;setTimeout((()=>{$(e.parentNode).html(`<a href="${n}" target="_blank">${t}</a>`)}),100)}};tasktopJiraIdHyperlinkingManyIds=e=>{if(/^((VIZ|APPS|CON|viz|con|apps)\-\d*\,).*(VIZ|APPS|CON|viz|con|apps)\-\d*$/.test(e.textContent)&&!$(e.parentNode).is("a")){let t=e.textContent.replaceAll(" ","").replaceAll(",","%2c"),n=`https://tasktop${window.location.href.includes("planview.lightning")?"":"-sandbox"}.atlassian.net/browse/${e.textContent.split(",")[0]}?jql=key%20in%20(${t})`;setTimeout((()=>{$(e.parentNode).html(`<a href="${n}" target="_blank">${e.textContent}</a>`)}),100)}};supportScoreInReportsHighlighting1=e=>{if("Support Score"==e.textContent){let t=$(e.parentNode),n=t.closest("th"),s=t.closest("table");if(n.length>0){let e=n.index()+1,t=s.find(`td:nth-child(${e}) span.css-13whmom`);t.length,t.each(((e,t)=>{let n=(t=$(t)).closest("td");this.supportScoreHighlight(n,t.html())}))}}};supportScoreInReportsHighlighting2=e=>{if(/^\d*\.\d*$/.test(e.textContent)){let t=$(e.parentNode),n=this.supportScoreTd(t);n&&this.supportScoreHighlight(n,t.html())}};supportScoreTd=e=>{let t=e.closest("td"),n=t.attr("data-column-index"),s=e.closest("table").find('span[data-tooltip="Support Score"]').closest("th").attr("data-column-index");return!(!n||!s||n!=s)&&t};supportScoreInTableHighlighting=e=>{if(!isNaN(e.textContent)){let t=$(e.parentNode).closest("table");if(t.length>0){let e=$(t).find('th[title="Support Score"]');if(e.length>0){let n=e.index()+1;t.find(`td:nth-child(${n}) span.slds-truncate.uiOutputNumber`).each(((e,t)=>{t=$(t),this.supportScoreHighlight(t.parent().parent(),t.html())}))}}}};defectRequestIssueInTableHyperlinking=e=>{if(/^https:\/\//.test(e.textContent)){let t=$(e.parentNode).closest("table");if(t.length>0){let e=$(t).find('th[title="Defect Request Issue"]');if(e.length>0){let n=e.index()+1;t.find(`td:nth-child(${n}) span.slds-truncate.uiOutputText`).each(((e,t)=>{let n=$(t).html();if(/^https:\/\//.test(n)){let e=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(n)?n.split("/").pop():n;$(t).html(`<a href="${n}" target="_blank">${e}</a>`)}}))}}}};clickOnInternalOnly=e=>{"Internal Only"==e.textContent&&JSON.parse(GLOBAL.settingsManager.settings.autoClickInternalUpdatesTab)&&$(e.parentNode).click()};color=e=>{for(let t in this.textMatchStyles){let n=this.textMatchStyles[t];if(n.exactMatch&&n.text==e.textContent||!n.exactMatch&&e.textContent.includes(n.text))if(n.ancestorToHighlight&&Array.isArray(n.ancestorToHighlight)){let t=!1;for(let s in n.ancestorToHighlight){let i=n.ancestorToHighlight[s],o=$(e.parentNode).closest(i);if(o.length>0){t=!0,this.styleThis(o,n);break}}!t&&n.highlightIfAncestorNotFound&&this.styleThis($(e.parentNode),n)}else this.styleThis($(e.parentNode),n)}};styleThis=(e,t)=>{e.css("background-color",t.bgColor),e.css("color",t.textColor)};gatherCaseIdNumberPairs=e=>{if(/^\d{8}$/.test(e.textContent)&&$(e.parentNode).hasClass("uiOutputText")&&$(e.parentNode.parentNode).hasClass("test-splitViewCardData")){let t=$(e.parentNode).closest("a").attr("data-recordid");GLOBAL.caseIdNumberPairs[e.textContent]={caseNumber:e.textContent,caseId:t,textNode:e,highlighted:!1},GLOBAL.caseIdNumberPairs[t]={caseNumber:e.textContent,caseId:t,textNode:e,highlighted:!1},this.monitorActiveCasesAsTheyAppear()}};monitorActiveCasesAsTheyAppear=()=>{GLOBAL.activeCaseId=GLOBAL.pathname.split("/")[GLOBAL.pathname.split("/").length-2],Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())};defectRequestMod=e=>{const t="Defect Request Issue",n=`span:contains('${t}')`,s=$(e).find(n).filter((function(){return $(this).text()==t}));if(s.length>0){const e=s.parent().siblings().find("span span");if(e.length>0){let t=e.html();if(/^http.*\:\/\/.*\./.test(t)&&!t.includes(" ")){let n=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(t)?t.split("/").pop():t;e.html(`<a href='${t}' target='_blank'>${n}</a>`)}}}};accessLinkMod=e=>{const t="Access Link",n=`span:contains('${t}')`,s=$(e).find(n).filter((function(){return $(this).text()==t}));if(s.length>0){const t=s.parent().siblings().find("span.uiOutputTextArea"),n="string"!=typeof t.html()||""==t.html().replace(/<a.*<\/a>/g,"").replace(/<\!--.*-->/g,""),i=s.parent().siblings().find("a");if(n&&1==i.length){const t=i.attr("href"),n=this.accessLinkExpiration(t);let s=n.label,o=n.color;/^((https|http|HTTPS|HTTP):\/\/.*(EXP|exp).*(CSIG|csig)[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|])$/g.test(t)?/^((https|http|HTTPS|HTTP):\/\/.*(EXP|exp).*(CSIG|csig)[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|])$/g.test(t)&&(o="green"):(s="Invalid access link",o="red"),i.html(s),i.css("color",o),n.expired||this.keepALupdated(e)}else(!n||i.length>1)&&(t.html("Invalid access link"),t.css("color","red"))}};accessLinkExpiration=e=>{let t="exp%3D",n=e.search(t);-1==n&&(t="exp=",n=e.search(t));const s=Number(e.substring(n+t.length,n+t.length+14)),i=new Date(new Date(s).setFullYear(new Date(s).getFullYear()-1969)),o=new Date;let a,l="red",r=!1;if(i>o){let e=Math.abs(i-o)/1e3;const t=Math.floor(e/86400);e-=86400*t;const n=Math.floor(e/3600)%24;e-=3600*n;e-=60*(Math.floor(e/60)%60);Math.floor(e);a=`Access link (expires in ${t} days ${n} hours)`,t>5?l="green":t>=1&&(l="orange")}else a=`Access link expired on ${i}`,r=!0;return{label:a,color:l,expired:r}};keepALupdated=e=>{setTimeout((()=>{this.accessLinkMod(e)}),36e5)}}class WhosLooking{constructor(){this.cooldown=1e3,this.caseIdSent=null,this.lastMouseActivitySent=null,this.lastKeyboardActivitySent=null,this.payload=null,this.callDetails=null}check=()=>{setTimeout((()=>{if(GLOBAL.settingsManager.settings.userName&&GLOBAL.activeCaseId&&GLOBAL.mouseMovedOn&&(GLOBAL.activeCaseId!=this.caseIdSent||GLOBAL.mouseMovedOn!=this.lastMouseActivitySent||GLOBAL.keyPressedOn!=this.lastKeyboardActivitySent)){let e=GLOBAL.keyPressedOn&&GLOBAL.keyPressedOn>GLOBAL.mouseMovedOn?GLOBAL.keyPressedOn:GLOBAL.mouseMovedOn;this.payload={caseId:GLOBAL.activeCaseId,name:GLOBAL.settingsManager.settings.userName,lastActivityTimestamp:e,lastKeypressTimestamp:GLOBAL.keyPressedOn,lastMouseMovement:GLOBAL.mouseMovedOn,backgroundColor:GLOBAL.settingsManager.settings.avatarColor,version:GLOBAL.version},this.callDetails={method:"POST",url:"http://whoslookingatcases.herokuapp.com/statusUpdate",data:JSON.stringify(this.payload),onload:this.updateUI},GM_xmlhttpRequest(this.callDetails)}this.check()}),this.cooldown)};updateUI=e=>{200==e.status?(GLOBAL.whosLookingResponse={response:JSON.parse(e.response),timestamp:Date.now()},this.caseIdSent=this.payload.caseId,this.lastMouseActivitySent=this.payload.lastMouseMovement,this.lastKeyboardActivitySent=this.payload.lastKeypressTimestamp):console.log("API error detected. Please get in touch with rpumputis@planview.com for support.")}}class SettingsManager{constructor(){this.settingsList=null,this.settings=null,this.defaultSettings={textMatchStyles:JSON.stringify([{text:"New",exactMatch:!0,bgColor:"#FFB648",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Initial",exactMatch:!0,bgColor:"#FFB648",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Active",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Needs Reply",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Internal Team Response",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Customer",exactMatch:!0,bgColor:"#3091EC",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"In Development",exactMatch:!0,bgColor:"#949494",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Release",exactMatch:!0,bgColor:"#2F3941",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Solution Provided",exactMatch:!0,bgColor:"#2F3941",textColor:"#D8DCDE",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"1 - Flagged to Case Owner",exactMatch:!0,bgColor:"#d9ead3",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"1 - Watching",exactMatch:!0,bgColor:"#d9ead3",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"2 - Elevated to Manager",exactMatch:!0,bgColor:"#ffe599",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"3 - Escalated to Development",exactMatch:!0,bgColor:"#f5b799",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"3 - Escalated to PM/Infrastructure team",exactMatch:!0,bgColor:"#f5b799",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"4 - Global XCAR",exactMatch:!0,bgColor:"#ea9999",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"To: Internal",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case status updated",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case updated",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case created",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"...",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Elite",exactMatch:!1,bgColor:"#ffcb2a",textColor:"",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!1},{text:"Premium",exactMatch:!1,bgColor:"#bababa",textColor:"",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!1},{text:"GREEN",exactMatch:!0,bgColor:"#d9ead3",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"AMBER",exactMatch:!0,bgColor:"#f5b799",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"RED",exactMatch:!0,bgColor:"#ea9999",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"Scheduled Task",exactMatch:!0,bgColor:"#3ba755",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Ongoing Activity",exactMatch:!0,bgColor:"#3ba755",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0}]),avatarColor:"#E34F32",autoClickInternalUpdatesTab:JSON.stringify(!1),userName:null,scrollbarWidth:3,listRefreshRate:60,reportRefreshRate:0,disableListRefresh:!1,closeAllTabsUsingCtrlQ:!1,openAllImagesUsingCtrlI:!1,allUrlHyperlinkingBeta:!1,ssRedThreshold:90,ssOrangeThreshold:80,ssYellowThreshold:70,overrideStandardFeedFont:!1,customFeedFont:"",feedFontFamily:"Sans-Serif",feedFontSize:"12"},this.run()}getSettingsList=()=>(this.settingsList=GM_listValues(),this.settingsList);getSettings=()=>{let e={};for(let t in this.settingsList){let n=this.settingsList[t];e[n]=GM_getValue(n)}return this.settings=e,this.settings};update=(e,t)=>(GM_setValue(e,t),this.settingsList.push(e),this.settings[e]=t,this.settings);applyDefaultSettings=()=>{"v20230623"==GLOBAL.version&&"v20230623"!=this.settings.clearedTextMatchStylesInVersion&&(this.update("clearedTextMatchStylesInVersion","v20230623"),this.update("textMatchStyles",JSON.stringify(JSON.parse(this.defaultSettings.textMatchStyles),void 0,4)),this.getSettingsList(),this.getSettings(),console.log(this.settings));for(let e in this.defaultSettings)Object.keys(this.settings).includes(e)||(this.settings[e]=this.defaultSettings[e]);return this.settings};run=()=>{this.getSettingsList(),this.getSettings(),this.applyDefaultSettings()}}class UIinjector{constructor(){this.userName=null,this.addStyles(),this.uiEvents(),this.whosLookingText=null,this.whosLookingResponseTimestamp=null}addStyles=()=>{GM_addStyle(GM_getResourceText("popupStyleCSS")),GM_addStyle(`\n            ::-webkit-scrollbar {\n                width: ${GLOBAL.settingsManager.settings.scrollbarWidth}px;\n                height: ${GLOBAL.settingsManager.settings.scrollbarWidth}px;\n            }\n            .big-blue-button {\n            background-color: rgb(1, 118, 211);\n            color: white;\n            padding: 10px;\n            font-size: large;\n            font-weight: bolder;\n            border-radius: 0.25rem;\n            cursor: pointer;\n                display: inline-block;\n                margin-right: 10px;\n        }\n        #roland-ui-mods-header-buttons {\n            left: 100px;\n            position: absolute;            \n        }`),GM_addStyle(`.roland-ui-mods-whoslooking-indicator {\n            background-color: ${GLOBAL.settingsManager.settings.avatarColor};\n            color: white;\n            padding: 3px 7px 1px 7px;\n            font-size: medium;\n            font-weight: bolder;\n            border-radius: 0.25rem;\n            cursor: help;\n            margin-right: 3px;\n            display: inline-block;\n        }\n        .tiblock {\n            align-items: center;\n            display: flex;\n            height: 8px;\n        }\n        .ticontainer .tidot {\n            background-color: white;\n        }\n        .tidot {\n            -webkit-animation: mercuryTypingAnimation 1.5s infinite ease-in-out;\n            border-radius: 2px;\n            display: inline-block;\n            height: 4px;\n            margin: 2px;\n            width: 3px;\n        }\n        .roland-hide{\n            opacity: 0;\n        }\n        @-webkit-keyframes mercuryTypingAnimation{\n        0%{\n        -webkit-transform:translateY(0px)\n        }\n        28%{\n        -webkit-transform:translateY(-5px)\n        }\n        44%{\n        -webkit-transform:translateY(0px)\n        }\n        }\n        .tidot:nth-child(1){\n        -webkit-animation-delay:200ms;\n        }\n        .tidot:nth-child(2){\n        -webkit-animation-delay:300ms;\n        }\n        .tidot:nth-child(3){\n        -webkit-animation-delay:400ms;\n        }`),GM_addStyle(".big-blue-button:hover {\n            background-color: rgb(1, 68, 134);\n        }"),GM_addStyle('\n        .roland-ui-mods-form-heading {\n            font-weight: bold;\n            font-style: italic;\n            border-bottom: 2px solid #ddd;\n            margin-bottom: 20px;\n            font-size: 15px;\n            padding-bottom: 3px;\n        }\n        .roland-ui-mods-form label{\n            display: block;\n            margin: 0px 0px 15px 0px;\n        }\n        .roland-ui-mods-form label > span{\n            width: 340px;\n            font-weight: bold;\n            float: left;\n            padding-top: 8px;\n            padding-right: 5px;\n        }\n        .roland-ui-mods-form input.roland-ui-mods-input-field,\n        .roland-ui-mods-form .roland-ui-mods-textarea-field {\n            box-sizing: border-box;\n            -webkit-box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            border: 1px solid #C2C2C2;\n            box-shadow: 1px 1px 4px #EBEBEB;\n            -moz-box-shadow: 1px 1px 4px #EBEBEB;\n            -webkit-box-shadow: 1px 1px 4px #EBEBEB;\n            border-radius: 3px;\n            -webkit-border-radius: 3px;\n            -moz-border-radius: 3px;\n            padding: 7px;\n            outline: none;\n        }\n        .roland-ui-mods-form .roland-ui-mods-input-field:focus,\n        .roland-ui-mods-form .roland-ui-mods-textarea-field:focus {\n            border: 1px solid #0C0;\n        }\n        .roland-ui-mods-form .roland-ui-mods-textarea-field{\n            height:300px;\n            width: 100%;\n            margin-top: 10px;\n        }\n        .roland-ui-mods-form input[type="checkbox"] {margin-top: 10px;}')};showWhosLooking=()=>{setTimeout((()=>{this.whosLookingText!=GLOBAL.whosLookingText&&(this.whosLookingText=GLOBAL.whosLookingText),GLOBAL.whosLookingResponse&&(this.whosLookingResponseTimestamp=GLOBAL.whosLookingResponse.timestamp,this.injectWhosLookingIndicator()),this.showWhosLooking()}),1e3)};injectWhosLookingIndicator=()=>{let e=$("div.feedActions.slds-grid");$(".roland-ui-mods-whoslooking-indicator").remove();for(let t in GLOBAL.whosLookingResponse.response){let n=GLOBAL.whosLookingResponse.response[t],s=~~(Date.now()/1e3)-~~(n.lastActivityTimestamp/1e3),i=100,o=300,a=1-.8*(s/i<1?s/i:1);e.prepend(this.whosLookingIndicatorTemplate({title:`${n.name} was active on this case ${s}s ago`,initials:this.nameToInitials(n.name),opacity:a,show:!(o<s),isTyping:Date.now()-n.lastKeypressTimestamp<5e3,backgroundColor:n.backgroundColor}))}};nameToInitials=e=>{let t=e.split(" "),n="";for(let e in t)n+=t[e].charAt(0);return n.toUpperCase()};setUserName=e=>{this.userName=e,this.injectSettingsButton(),this.showWhosLooking()};whosLookingIndicatorTemplate=e=>e.show?`<div class='roland-ui-mods-whoslooking-indicator' style='opacity: ${e.opacity}; background-color: ${e.backgroundColor}' title='${e.title}'>\n        <div>${e.initials}</div>\n           <div class="ticontainer ${e.isTyping?"":"roland-hide"}">\n               <div class="tiblock">\n                   <div class="tidot"></div>\n                   <div class="tidot"></div>\n                   <div class="tidot"></div>\n               </div>\n           </div>\n       </div>`:"";settingsButtonTemplate=()=>"<div class=\"big-blue-button\" id='roland-ui-mods-settings-button'>Service Cloud Premium</div>";headerButtonsTemplate=()=>`<div id="roland-ui-mods-header-buttons">${this.settingsButtonTemplate()}</div>`;settingsMenuTemplate=()=>`<div class="roland-ui-mods-form">\n        <div class="roland-ui-mods-form-heading">Release notes for version: ${GLOBAL.version}</div>\n        <ul>\n          <li>&bull;&nbsp;Josh's request: Hide milestone panel when milestones are completed.<br><br>\n          <li>&bull;&nbsp;Thomas Bambuch's request: Fix the expansion of internal post box when making large internal posts.<br><br>\n        </ul>\n        <br>\n  \n        <div class="roland-ui-mods-form-heading">Settings</div>\n        <form>\n          <label><span>Avatar color</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="avatarColor" id="avatar-color-input" value="${GLOBAL.settingsManager.settings.avatarColor}"/></label>\n          <label><span>Scrollbar width</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="scrollbarWidth" id="scrollbar-width-input" value="${GLOBAL.settingsManager.settings.scrollbarWidth}"/></label>\n          <label><span>Auto-click "Internal Only"</span><input class="roland-ui-mods-settings-input" data-id="autoClickInternalUpdatesTab" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.autoClickInternalUpdatesTab)?"checked":""}/></label>\n          <label><span>Disable list refresh (Bobby's meeting mode)</span><input class="roland-ui-mods-settings-input" data-id="disableListRefresh" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.disableListRefresh)?"checked":""}/></label>\n          <label><span>List refresh rate (in seconds)</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="listRefreshRate" value="${GLOBAL.settingsManager.settings.listRefreshRate}"/></label>\n          <label><span>Report refresh rate (in seconds)</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="reportRefreshRate" value="${GLOBAL.settingsManager.settings.reportRefreshRate}"/></label>\n          <label><span>Use CTRL+Q to close all tabs</span><input class="roland-ui-mods-settings-input" data-id="closeAllTabsUsingCtrlQ" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.closeAllTabsUsingCtrlQ)?"checked":""}/></label>\n          <label><span>Use CTRL+I to open all images</span><input class="roland-ui-mods-settings-input" data-id="openAllImagesUsingCtrlI" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.openAllImagesUsingCtrlI)?"checked":""}/></label>\n          <label><span>Hyperlink URLs when possible (<span style="text-decoration: underline; color: blue;" title='If you notice issues with links not working, please disable and refresh.'>BETA</span>)</span><input class="roland-ui-mods-settings-input" data-id="allUrlHyperlinkingBeta" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.allUrlHyperlinkingBeta)?"checked":""}/></label>\n          <label><span>Support Score red threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssRedThreshold" value="${GLOBAL.settingsManager.settings.ssRedThreshold}"/></label>\n          <label><span>Support Score orange threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssOrangeThreshold" value="${GLOBAL.settingsManager.settings.ssOrangeThreshold}"/></label>\n          <label><span>Support Score yellow threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssYellowThreshold" value="${GLOBAL.settingsManager.settings.ssYellowThreshold}"/></label>\n          <label><span>Override standard feed font (<span style="text-decoration: underline; color: blue;" title='If disabled, below feed font settings will not be applied.'>info</span>)</span><input class="roland-ui-mods-settings-input" data-id="overrideStandardFeedFont" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.overrideStandardFeedFont)?"checked":""}/></label>\n          <label><span>Custom feed font (<span style="text-decoration: underline; color: blue;" title='If a valid and available font is entered it will be used instead of the below feed font selected in the picklist.'>info</span>)</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="customFeedFont" value="${GLOBAL.settingsManager.settings.customFeedFont}"/></label>\n          <label><span>Feed font (<span style="text-decoration: underline; color: blue;" title='This will be used if custom feed font is blank'>info</span>)</span><div style='display:inline-block;'><div>${this.feedFontSelectorHTML(GLOBAL.settingsManager.settings.feedFontFamily)}</div><div id='abcxyz' style='padding-top:10px;font-family:${GLOBAL.settingsManager.settings.feedFontFamily};'>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</div></div></label>\n          <label><span>Feed font size</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="feedFontSize" value="${GLOBAL.settingsManager.settings.feedFontSize}"/></label>\n          <label><span>Text match styles</span><textarea class="roland-ui-mods-textarea-field  roland-ui-mods-settings-input" data-id="textMatchStyles">${JSON.stringify(JSON.parse(GLOBAL.settingsManager.settings.textMatchStyles),void 0,4)}</textarea></label>\n        </form>\n      </div>`;feedFontSelectorHTML=e=>{const t=[];for(let e in GLOBAL.availableFonts)t.push({name:GLOBAL.availableFonts[e],selected:!1});return`<select id="feed-font-selector" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="feedFontFamily">\n                    ${t.map((t=>(t.selected=t.name==e,t))).map((e=>this.feedFontOptionHTML(e)))}\n                </select>`};feedFontOptionHTML=e=>`<option value="${e.name}" ${e.selected?'selected ="selected"':""}>${e.name}</option>`;injectSettingsButton=e=>{$("div.slds-global-header > div:nth-child(1)").length>0?(console.log("header found, injecting button..."),GLOBAL.headerFound=!0,$("div.slds-global-header > div:nth-child(1)").after(this.headerButtonsTemplate())):e?console.log("failed to find the header..."):(console.log("header not found, retrying in 5s..."),setTimeout((()=>{this.injectSettingsButton(!0)}),5e3))};uiEvents=()=>{$(document).ready((()=>{$(document).off("click","#roland-ui-mods-settings-button").on("click","#roland-ui-mods-settings-button",(e=>{this.settingsButtonClicked(e)})),$(document).off("click","#feed-font-selector").on("click","#feed-font-selector",(e=>{$("#abcxyz").css("fontFamily",e.target.value)})),document.addEventListener("mousemove",this.saveMouseMovementTime,!1),document.addEventListener("keydown",this.saveKeypressTime)})),document.onkeydown=this.keyPress};keyPress=e=>{let t=window.event?event:e;if(81==t.keyCode&&t.ctrlKey&&GLOBAL.settingsManager.settings.closeAllTabsUsingCtrlQ&&this.closeTabs(),73==t.keyCode&&t.ctrlKey&&GLOBAL.settingsManager.settings.openAllImagesUsingCtrlI){let e=$('a[href*="AttachedContentDocuments"] .view-all-label');GLOBAL.fileLinks?this.openImages():e.length>0&&(e.click(),this.waitForFileLinks())}};waitForFileLinks=async()=>{GLOBAL.fileLinks||(GLOBAL.fileLinks=await new Promise((e=>{GLOBAL.imageUrlResolvedCallback=e}))),this.openImages()};tryToFindFileLinks=()=>{console.log("trying to find links");let e=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");e.length>0&&(GLOBAL.fileLinks=e),console.log(e)};openImages=async()=>{GLOBAL.attachedImageUrls=[];let e=[];GLOBAL.fileLinks.each(((t,n)=>{e.push(n)}));for(let t in e){e[t].click(),await new Promise((e=>{GLOBAL.imageUrlResolvedCallback=e})),$('div.forceContentBasePreviewToolbar button[title="Close"]').click()}let t=this.addImagesToDiv(GLOBAL.imageContainerDiv,GLOBAL.attachedImageUrls);this.showImagePopup(t)};showImagePopup=e=>{let t={title:"Images",content:`<div style="padding: 15px;text-align:center;">${e}</div>`,buttons:{Close:{handler:null}},keyEvents:{13:{handler:null},27:{handler:null}},dim:!0,expandStepDuration:500,collapseStepDuration:300,expandCallback:null,collapseCallback:this.closeFilesTab},n=new Popup(t);n.keyEvents[13].handler=n.collapse,n.keyEvents[27].handler=n.collapse,n.buttons.Close.handler=n.collapse,$("body").append('<div id="roland-ui-mods-image-viewer-popup" style="padding:5px;position:fixed;width:90%;height:90%;top:5%;left:5%;z-index:9000;"></div>'),n.render("roland-ui-mods-image-viewer-popup"),n.expand()};closeFilesTab=()=>{GLOBAL.fileTabCloseButton&&GLOBAL.fileTabCloseButton.click(),console.log("close")};addImagesToDiv=(e,t)=>{let n="";for(let e in t)n+=`<img style="border: 1px solid #333;" src='${t[e]}'><br><br>`;return e.html(n),this.styleDiv(e),n};styleDiv=e=>{e.css({display:"block",overflow:"scroll","text-align":"center",padding:"100px"})};closeTabs=()=>{let e=$('button.slds-button.slds-button_icon.slds-button_icon-x-small.slds-button_icon-container[title^="Close "]');e.length>0&&e.click()};toggleWidenModeButtonClicked=()=>{console.log("toggle");let e=$('a:contains("Contact Details")');this.toggleOffsetAncestor(e,"[id^='leftColumn-']")};toggleOffsetAncestor=(e,t)=>(console.log(e),e.is(t)?(console.log("toggling"),e.hide(),e.next().css("width","100%"),!0):e.offsetParent().length>0?(console.log("looking deeper"),this.toggleOffsetAncestor(e.offsetParent(),t)):(console.log("fail"),!1));saveMouseMovementTime=()=>{GLOBAL.mouseMovedOn=Date.now()};saveKeypressTime=()=>{GLOBAL.keyPressedOn=Date.now()};getAvailableFonts=async()=>{const e=new Set(["Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","Leelawadee UI","Lucida Console","Lucida Sans Unicode","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MV Boli","Myanmar Text","Nirmala UI","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimSun","Sitka","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic","American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","Futura","Geneva","Georgia","Gill Sans","Helvetica","Helvetica Neue","Herculanum","Hoefler Text","Impact","Lucida Grande","Luminari","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Optima","Palatino","Papyrus","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Zapfino"].sort());await document.fonts.ready;const t=new Set;for(const n of e.values())document.fonts.check(`12px "${n}"`)&&t.add(n);return GLOBAL.availableFonts=[...t.values()],GLOBAL.availableFonts};settingsButtonClicked=async e=>{await this.getAvailableFonts();let t={title:`Service Cloud Premium ${GLOBAL.version}`,content:`<div style="padding: 15px;">${this.settingsMenuTemplate()}</div>`,buttons:{Cancel:{handler:null},Save:{handler:null}},keyEvents:{13:{handler:null},27:{handler:null}},dim:!0,expandStepDuration:500,collapseStepDuration:300,expandCallback:null,collapseCallback:null},n=new Popup(t);n.keyEvents[27].handler=n.collapse,n.buttons.Save.handler=partial(this.saved,n.collapse),$("body").append('<div id="roland-ui-mods-settings-popup" style="padding:5px;position:fixed;width:70%;height:70%;top:15%;left:15%;z-index:9000;"></div>'),n.render("roland-ui-mods-settings-popup"),n.expand(e)};saved=e=>{let t;$(".roland-ui-mods-settings-input").each(((e,n)=>{let s,i=$(n),o=i.attr("data-id");i.is('input[type="text"]')?s=i.val():i.is('input[type="checkbox"]')?s=i.is(":checked"):(i.is("textarea")||i.is("select"))&&(s=i.val()),t=GLOBAL.settingsManager.update(o,s)})),e()}}const GLOBAL={totalTimeSpentInRolandUImodsScript:0,totalTimeSpent:0,mutationObserverRegistry:null,activeCaseNumber:null,activeCaseId:null,activeCaseElementToHighlight:null,caseIdNumberPairs:{},activeCaseStatus:null,userName:null,profileButton:null,pathname:window.location.pathname,mouseMovedOn:null,keyPressedOn:null,headerFound:!1,imageOpenerButtonsList:{},attachedImageUrls:[],imageUrlResolvedCallback:null,imageContainerDiv:null,fileLinks:null,fileTabCloseButton:null,version:"v20231114"},rolandUImods=()=>{console.log("Service Cloud Premium version:",GLOBAL.version),GLOBAL.settingsManager=new SettingsManager,GLOBAL.mutationObserverRegistry=new MutationObserverRegistry("Global"),GLOBAL.mutationObserverRegistry.observer.observe(document.body,{subtree:!0,childList:!0,attributes:!0,characterData:!0}),GLOBAL.conditionalFormatting=new ConditionalFormatting,GLOBAL.uiInjector=new UIinjector,GLOBAL.conditionalFormatting.run(),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(detectUserName),exposeUserName();(new WhosLooking).check(),overrideListRefreshRate(),refreshLists(),refreshReports()},overrideListRefreshRate=()=>{setTimeout((()=>{refreshListsInSeconds?refreshListsInSeconds=2e6:overrideListRefreshRate()}),1e3)},refreshLists=()=>{isNaN(parseFloat(GLOBAL.settingsManager.settings.listRefreshRate))||setTimeout((()=>{if(!GLOBAL.settingsManager.settings.disableListRefresh){let e=$($("button",$("force-list-view-manager-button-bar"))[0]);e.length>0&&e.click()}refreshLists()}),1e3*parseFloat(GLOBAL.settingsManager.settings.listRefreshRate))},refreshReports=()=>{!isNaN(parseFloat(GLOBAL.settingsManager.settings.reportRefreshRate))&&GLOBAL.settingsManager.settings.reportRefreshRate>0&&setTimeout((()=>{let e=$($(".report-action-refreshReport")[0]);e.length>0&&e.click(),refreshReports()}),1e3*parseFloat(GLOBAL.settingsManager.settings.reportRefreshRate))};function partial(e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.concat(Array.prototype.slice.call(arguments));return e.apply(this,n)}}const detectUserName=e=>{const t=$(e).find("h1.profile-card-name a");t.length>0&&null!=GLOBAL.profileButton&&null==GLOBAL.settingsManager.settings.userName&&(GLOBAL.settingsManager.update("userName",t.html()),GLOBAL.uiInjector.setUserName(GLOBAL.settingsManager.settings.userName),setTimeout((()=>{GLOBAL.profileButton.click()}),100))},exposeUserName=()=>{if(null==GLOBAL.settingsManager.settings.userName){const e=$("button.branding-userProfile-button");e.length>0?(GLOBAL.profileButton=e.get(0),tryOpeningProfilePopupToLookForName()):setTimeout((()=>{exposeUserName()}),15e3)}else GLOBAL.uiInjector.setUserName(GLOBAL.settingsManager.settings.userName)},tryOpeningProfilePopupToLookForName=()=>{null==GLOBAL.settingsManager.settings.userName&&(GLOBAL.profileButton.click(),setTimeout((()=>{0==$("h1.profile-card-name").length&&tryOpeningProfilePopupToLookForName()}),15e3))};