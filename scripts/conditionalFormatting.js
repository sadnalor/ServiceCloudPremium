class MutationObserverRegistry{constructor(t){this.functionsForAnyMutation=[],this.functionsForNodeAddition=[],this.observerName=t}addFunctionForAnyMutation=t=>this.functionsForAnyMutation.push(t);addFunctionForNodeAddition=t=>this.functionsForNodeAddition.push(t);observer=new MutationObserver((t=>{const e=Date.now();for(let e in t){let n=t[e];if(n.addedNodes&&n.addedNodes.length>0){let t=Array.from(n.addedNodes);for(let e in t){let n=t[e];for(let t in this.functionsForNodeAddition){(0,this.functionsForNodeAddition[t])(n,this.observerName)}}}for(let t in this.functionsForAnyMutation){(0,this.functionsForAnyMutation[t])(n,this.observerName)}}const n=Date.now();GLOBAL.totalTimeSpentInRolandUImodsScript+=n-e}))}class ConditionalFormatting{constructor(){this.textMatchStyles=JSON.parse(GLOBAL.settingsManager.settings.textMatchStyles)}run=()=>{GLOBAL.mutationObserverRegistry.addFunctionForAnyMutation(this.processMutation),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.processTextNode),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.accessLinkMod),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(this.defectRequestMod)};processMutation=(t,e)=>{this.expandEmailInput(t),this.monitorActiveCaseWhenUrlChanges(t),this.listenForAttachedImages(t)};listenForAttachedImages=t=>{const e=$(t.target);if(e.hasClass("forceContentModalPreviewPlayer")){GLOBAL.imageContainerDiv=e.find("div.thumbnail img.pageImg").parent();let t=e.find("div.thumbnail img.pageImg").attr("src"),n=e.find("img.pageImg").attr("src");t&&GLOBAL.attachedImageUrls.push(t),GLOBAL.imageUrlResolvedCallback&&(t||n)&&GLOBAL.imageUrlResolvedCallback(t)}};expandEmailInput=t=>{const e=$(t.target);if(e.hasClass("uiInput")){const t=e.find("iframe");if(t.length>0){const e="#cke_1_contents",n=$(t[0]).contents().find(e),o=$(t[0]).contents().find("iframe");if(o.length>0){const t=$(o[0]).contents().find("body");t.length>0&&(n.height(t.outerHeight()+20),GLOBAL.keyPressedOn=Date.now())}}}};tryToFindFileLinks=()=>{console.log("trying to find links");let t=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");t.length>0&&(GLOBAL.fileLinks=t),console.log(t)};monitorActiveCaseWhenUrlChangesOld=()=>{if(window.location.pathname!=GLOBAL.pathname){GLOBAL.pathname=window.location.pathname,GLOBAL.fileLinks=null,console.log("links cleared"),this.tryToFindFileLinks();let t=GLOBAL.pathname.split("/");t.length>3&&"case"==t[t.length-3].toLowerCase()?GLOBAL.activeCaseId=t[t.length-2]:GLOBAL.activeCaseId=null,Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())}};monitorActiveCaseWhenUrlChanges=()=>{if(window.location.pathname!=GLOBAL.pathname){GLOBAL.pathname=window.location.pathname;let t=GLOBAL.pathname.split("/");t.length>4&&"case"==t[3].toLowerCase()?(console.log(GLOBAL.activeCaseId),console.log(t[4]),GLOBAL.activeCaseId!=t[4]&&GLOBAL.activeCaseId&&(GLOBAL.fileLinks=null,console.log("links cleared")),GLOBAL.activeCaseId=t[4]):GLOBAL.activeCaseId=null,Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())}};highlightActiveCase=()=>{if(!GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].highlighted){for(let t in GLOBAL.caseIdNumberPairs)GLOBAL.caseIdNumberPairs[t].highlighted=!1;GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].highlighted=!0,$(".conditional-formatting-highlighted-case").css("background-color",""),$(".conditional-formatting-highlighted-case").removeClass(".conditional-formatting-highlighted-case");let t=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseNumber].textNode,e=$(t).closest(".slds-split-view__list-item");if(e.length>0){let t=this.getStyleBasedOnTextArray(this.getTextFromNode(e.get(0))),n=null!=t.bgColor?t.bgColor:"";for(let t in this.textMatchStyles){let e=this.textMatchStyles[t];if(e.text==GLOBAL.activeCaseStatus){n=e.bgColor;break}}e.addClass("conditional-formatting-highlighted-case"),e.css("background-color",n)}}};getStyleBasedOnTextArray=t=>{for(let e in t){let n=t[e];for(let t in this.textMatchStyles){let e=this.textMatchStyles[t];if(e.text==n)return e}}return null};getTextFromNode=t=>{let e,n=[],o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;e=o.nextNode();)n.push(e.textContent);return n};processTextNode=t=>{const e=Date.now();let n,o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;n=o.nextNode();)this.clickOnInternalOnly(n),this.color(n),this.gatherCaseIdNumberPairs(n),GLOBAL.settingsManager.settings.allUrlHyperlinkingBeta?this.allUrlHyperlinking(n):this.defectRequestIssueInTableHyperlinking(n),this.findFilesSection(n),this.findEscalatedToT3OrDevWarning(n),this.supportScoreHighlightInPanels(n),this.supportScoreInTableHighlighting(n),this.supportScoreInReportsHighlighting1(n),this.supportScoreInReportsHighlighting2(n);const s=Date.now();GLOBAL.totalTimeSpent+=s-e};displayTimeSpent=()=>{setTimeout((()=>{console.log("Time spent:",GLOBAL.totalTimeSpent),this.displayTimeSpent()}),1e3)};supportScoreHighlightInPanels=t=>{if("Support Score"==t.textContent){let e=$(t.parentNode).closest("div.slds-form-element"),n=e.find("span.uiOutputNumber");this.supportScoreHighlight(e,n.html())}};supportScoreHighlight=(t,e)=>{let n=isNaN(parseFloat(e))?0:parseFloat(e);n>GLOBAL.settingsManager.settings.ssRedThreshold?t.css("background-color","#ea9999"):n>GLOBAL.settingsManager.settings.ssOrangeThreshold?t.css("background-color","#f5b799"):n>GLOBAL.settingsManager.settings.ssYellowThreshold?t.css("background-color","#ffe599"):t.css("background-color","#d9ead3")};findEscalatedToT3OrDevWarning=t=>{if("WARNING!!! This case has already been escalated to Tier 3 or Dev. Do not click save!"==t.textContent){$(t.parentNode).closest("div.uiTabset--base").find('span.title:contains("T3")').closest("li").hide(),$('span.title:contains("Post")').click()}};findFilesSection=t=>{if("Files"==t.textContent){$(t.parentNode).closest(".forceListViewManager").length>0&&this.waitForFileLinks()}};waitForFileLinks=()=>{setTimeout((()=>{let t=$('button[title="Close Files"]');console.log("close button",t),t.length>0&&(GLOBAL.fileTabCloseButton=t);let e=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");e.length>0?(GLOBAL.fileLinks=e,"function"==typeof GLOBAL.imageUrlResolvedCallback&&GLOBAL.imageUrlResolvedCallback(e)):this.waitForFileLinks()}),100)};allUrlHyperlinking=t=>{if(/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:\/~+#-]*[\w@?^=%&\/~+#-])?$/.test(t.textContent)&&!$(t.parentNode).is("a")){let e=t.textContent,n=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(e)?e.split("/").pop():e;$(t.parentNode).html(`<a href="${e}" target="_blank">${n}</a>`)}};supportScoreInReportsHighlighting1=t=>{if("Support Score"==t.textContent){let e=$(t.parentNode),n=e.closest("th"),o=e.closest("table");if(n.length>0){let t=n.index()+1,e=o.find(`td:nth-child(${t}) span.css-13whmom`);e.length,e.each(((t,e)=>{let n=(e=$(e)).closest("td");this.supportScoreHighlight(n,e.html())}))}}};supportScoreInReportsHighlighting2=t=>{if(/^\d*\.\d*$/.test(t.textContent)){let e=$(t.parentNode),n=this.supportScoreTd(e);n&&this.supportScoreHighlight(n,e.html())}};supportScoreTd=t=>{let e=t.closest("td"),n=e.attr("data-column-index"),o=t.closest("table").find('span[data-tooltip="Support Score"]').closest("th").attr("data-column-index");return!(!n||!o||n!=o)&&e};supportScoreInTableHighlighting=t=>{if(!isNaN(t.textContent)){let e=$(t.parentNode).closest("table");if(e.length>0){let t=$(e).find('th[title="Support Score"]');if(t.length>0){let n=t.index()+1;e.find(`td:nth-child(${n}) span.slds-truncate.uiOutputNumber`).each(((t,e)=>{e=$(e),this.supportScoreHighlight(e.parent().parent(),e.html())}))}}}};defectRequestIssueInTableHyperlinking=t=>{if(/^https:\/\//.test(t.textContent)){let e=$(t.parentNode).closest("table");if(e.length>0){let t=$(e).find('th[title="Defect Request Issue"]');if(t.length>0){let n=t.index()+1;e.find(`td:nth-child(${n}) span.slds-truncate.uiOutputText`).each(((t,e)=>{let n=$(e).html();if(/^https:\/\//.test(n)){let t=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(n)?n.split("/").pop():n;$(e).html(`<a href="${n}" target="_blank">${t}</a>`)}}))}}}};clickOnInternalOnly=t=>{"Internal Only"==t.textContent&&JSON.parse(GLOBAL.settingsManager.settings.autoClickInternalUpdatesTab)&&$(t.parentNode).click()};color=t=>{for(let e in this.textMatchStyles){let n=this.textMatchStyles[e];if(n.exactMatch&&n.text==t.textContent||!n.exactMatch&&t.textContent.includes(n.text))if(n.ancestorToHighlight&&Array.isArray(n.ancestorToHighlight)){let e=!1;for(let o in n.ancestorToHighlight){let s=n.ancestorToHighlight[o],i=$(t.parentNode).closest(s);if(i.length>0){e=!0,this.styleThis(i,n);break}}!e&&n.highlightIfAncestorNotFound&&this.styleThis($(t.parentNode),n)}else this.styleThis($(t.parentNode),n)}};styleThis=(t,e)=>{t.css("background-color",e.bgColor),t.css("color",e.textColor)};gatherCaseIdNumberPairs=t=>{if(/^\d{8}$/.test(t.textContent)&&$(t.parentNode).hasClass("uiOutputText")&&$(t.parentNode.parentNode).hasClass("test-splitViewCardData")){let e=$(t.parentNode).closest("a").attr("data-recordid");GLOBAL.caseIdNumberPairs[t.textContent]={caseNumber:t.textContent,caseId:e,textNode:t,highlighted:!1},GLOBAL.caseIdNumberPairs[e]={caseNumber:t.textContent,caseId:e,textNode:t,highlighted:!1},this.monitorActiveCasesAsTheyAppear()}};monitorActiveCasesAsTheyAppear=()=>{GLOBAL.activeCaseId=GLOBAL.pathname.split("/")[GLOBAL.pathname.split("/").length-2],Object.keys(GLOBAL.caseIdNumberPairs).includes(GLOBAL.activeCaseId)&&(GLOBAL.activeCaseNumber=GLOBAL.caseIdNumberPairs[GLOBAL.activeCaseId].caseNumber,this.highlightActiveCase())};defectRequestMod=t=>{const e="Defect Request Issue",n=`span:contains('${e}')`,o=$(t).find(n).filter((function(){return $(this).text()==e}));if(o.length>0){const t=o.parent().siblings().find("span span");if(t.length>0){let e=t.html();if(/^http.*\:\/\/.*\./.test(e)&&!e.includes(" ")){let n=/^https:\/\/clarizenint\.atlassian\.net\/browse\/CLZDEV-\d*/.test(e)?e.split("/").pop():e;t.html(`<a href='${e}' target='_blank'>${n}</a>`)}}}};accessLinkMod=t=>{const e="Access Link",n=$(t).find("span:contains('Access Link')").filter((function(){return $(this).text()==e}));if(n.length>0){const e=n.parent().siblings().find("span.uiOutputTextArea"),o="string"!=typeof e.html()||""==e.html().replace(/<a.*<\/a>/g,"").replace(/<\!--.*-->/g,""),s=n.parent().siblings().find("a");if(o&&1==s.length){const e=s.attr("href"),n=this.accessLinkExpiration(e);let o=n.label,i=n.color;/^((https|http|HTTPS|HTTP):\/\/.*(EXP|exp).*(CSIG|csig)[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|])$/g.test(e)?/^((https|http|HTTPS|HTTP):\/\/.*(EXP|exp).*(CSIG|csig)[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|])$/g.test(e)&&(i="green"):(o="Invalid access link",i="red"),s.html(o),s.css("color",i),n.expired||this.keepALupdated(t)}else(!o||s.length>1)&&(e.html("Invalid access link"),e.css("color","red"))}};accessLinkExpiration=t=>{let e="exp%3D",n=t.search(e);-1==n&&(e="exp=",n=t.search(e));const o=Number(t.substring(n+e.length,n+e.length+14)),s=new Date(new Date(o).setFullYear(new Date(o).getFullYear()-1969)),i=new Date;let a,l="red",r=!1;if(s>i){let t=Math.abs(s-i)/1e3;const e=Math.floor(t/86400);t-=86400*e;const n=Math.floor(t/3600)%24;t-=3600*n;t-=60*(Math.floor(t/60)%60);Math.floor(t);a=`Access link (expires in ${e} days ${n} hours)`,e>5?l="green":e>=1&&(l="orange")}else a=`Access link expired on ${s}`,r=!0;return{label:a,color:l,expired:r}};keepALupdated=t=>{setTimeout((()=>{this.accessLinkMod(t)}),36e5)}}class WhosLooking{constructor(){this.cooldown=1e3,this.caseIdSent=null,this.lastMouseActivitySent=null,this.lastKeyboardActivitySent=null,this.payload=null,this.callDetails=null}check=()=>{setTimeout((()=>{if(GLOBAL.settingsManager.settings.userName&&GLOBAL.activeCaseId&&GLOBAL.mouseMovedOn&&(GLOBAL.activeCaseId!=this.caseIdSent||GLOBAL.mouseMovedOn!=this.lastMouseActivitySent||GLOBAL.keyPressedOn!=this.lastKeyboardActivitySent)){let t=GLOBAL.keyPressedOn&&GLOBAL.keyPressedOn>GLOBAL.mouseMovedOn?GLOBAL.keyPressedOn:GLOBAL.mouseMovedOn;this.payload={caseId:GLOBAL.activeCaseId,name:GLOBAL.settingsManager.settings.userName,lastActivityTimestamp:t,lastKeypressTimestamp:GLOBAL.keyPressedOn,lastMouseMovement:GLOBAL.mouseMovedOn,backgroundColor:GLOBAL.settingsManager.settings.avatarColor,version:GLOBAL.version},this.callDetails={method:"POST",url:"http://whoslookingatcases.herokuapp.com/statusUpdate",data:JSON.stringify(this.payload),onload:this.updateUI},GM_xmlhttpRequest(this.callDetails)}this.check()}),this.cooldown)};updateUI=t=>{200==t.status?(GLOBAL.whosLookingResponse={response:JSON.parse(t.response),timestamp:Date.now()},this.caseIdSent=this.payload.caseId,this.lastMouseActivitySent=this.payload.lastMouseMovement,this.lastKeyboardActivitySent=this.payload.lastKeypressTimestamp):console.log("API error detected. Please get in touch with rpumputis@planview.com for support.")}}class SettingsManager{constructor(){this.settingsList=null,this.settings=null,this.defaultSettings={textMatchStyles:JSON.stringify([{text:"New",exactMatch:!0,bgColor:"#FFB648",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Initial",exactMatch:!0,bgColor:"#FFB648",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Active",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Needs Reply",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Internal Team Response",exactMatch:!0,bgColor:"#E34F32",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Customer",exactMatch:!0,bgColor:"#3091EC",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"In Development",exactMatch:!0,bgColor:"#949494",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Pending Release",exactMatch:!0,bgColor:"#2F3941",textColor:"#ffffff",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"Solution Provided",exactMatch:!0,bgColor:"#2F3941",textColor:"#D8DCDE",ancestorToHighlight:[],highlightIfAncestorNotFound:!0},{text:"1 - Flagged to Case Owner",exactMatch:!0,bgColor:"#d9ead3",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"1 - Watching",exactMatch:!0,bgColor:"#d9ead3",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"2 - Elevated to Manager",exactMatch:!0,bgColor:"#ffe599",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"3 - Escalated to Development",exactMatch:!0,bgColor:"#f5b799",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"3 - Escalated to PM/Infrastructure team",exactMatch:!0,bgColor:"#f5b799",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"4 - Global XCAR",exactMatch:!0,bgColor:"#ea9999",textColor:"#000000",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!0},{text:"To: Internal",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case status updated",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case updated",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Case created",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"...",exactMatch:!0,bgColor:"#FFF6D9",textColor:"",ancestorToHighlight:[".cuf-element"],highlightIfAncestorNotFound:!1},{text:"Elite",exactMatch:!1,bgColor:"#ffcb2a",textColor:"",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!1},{text:"Premium",exactMatch:!1,bgColor:"#bababa",textColor:"",ancestorToHighlight:[".slds-form-element"],highlightIfAncestorNotFound:!1}]),avatarColor:"#E34F32",autoClickInternalUpdatesTab:JSON.stringify(!1),userName:null,scrollbarWidth:3,listRefreshRate:60,disableListRefresh:!1,closeAllTabsUsingCtrlQ:!1,openAllImagesUsingCtrlI:!1,allUrlHyperlinkingBeta:!1,ssRedThreshold:90,ssOrangeThreshold:80,ssYellowThreshold:70},this.run()}getSettingsList=()=>(this.settingsList=GM_listValues(),this.settingsList);getSettings=()=>{let t={};for(let e in this.settingsList){let n=this.settingsList[e];t[n]=GM_getValue(n)}return this.settings=t,this.settings};update=(t,e)=>(GM_setValue(t,e),this.settingsList.push(t),this.settings[t]=e,this.settings);applyDefaultSettings=()=>{"v20220420"==GLOBAL.version&&"v20220420"!=this.settings.clearedTextMatchStylesInVersion&&(this.update("clearedTextMatchStylesInVersion","v20220420"),this.update("textMatchStyles",JSON.stringify(JSON.parse(this.defaultSettings.textMatchStyles),void 0,4)),this.getSettingsList(),this.getSettings(),console.log(this.settings));for(let t in this.defaultSettings)Object.keys(this.settings).includes(t)||(this.settings[t]=this.defaultSettings[t]);return this.settings};run=()=>{this.getSettingsList(),this.getSettings(),this.applyDefaultSettings()}}class UIinjector{constructor(){this.userName=null,this.addStyles(),this.uiEvents(),this.whosLookingText=null,this.whosLookingResponseTimestamp=null}addStyles=()=>{GM_addStyle(GM_getResourceText("popupStyleCSS")),GM_addStyle(`\n            ::-webkit-scrollbar {\n                width: ${GLOBAL.settingsManager.settings.scrollbarWidth}px;\n                height: ${GLOBAL.settingsManager.settings.scrollbarWidth}px;\n            }\n            .big-blue-button {\n            background-color: rgb(1, 118, 211);\n            color: white;\n            padding: 10px;\n            font-size: large;\n            font-weight: bolder;\n            border-radius: 0.25rem;\n            cursor: pointer;\n                display: inline-block;\n                margin-right: 10px;\n        }\n        #roland-ui-mods-header-buttons {\n            left: 100px;\n            position: absolute;            \n        }`),GM_addStyle(`.roland-ui-mods-whoslooking-indicator {\n            background-color: ${GLOBAL.settingsManager.settings.avatarColor};\n            color: white;\n            padding: 3px 7px 1px 7px;\n            font-size: medium;\n            font-weight: bolder;\n            border-radius: 0.25rem;\n            cursor: help;\n            margin-right: 3px;\n            display: inline-block;\n        }\n        .tiblock {\n            align-items: center;\n            display: flex;\n            height: 8px;\n        }\n        .ticontainer .tidot {\n            background-color: white;\n        }\n        .tidot {\n            -webkit-animation: mercuryTypingAnimation 1.5s infinite ease-in-out;\n            border-radius: 2px;\n            display: inline-block;\n            height: 4px;\n            margin: 2px;\n            width: 3px;\n        }\n        .roland-hide{\n            opacity: 0;\n        }\n        @-webkit-keyframes mercuryTypingAnimation{\n        0%{\n        -webkit-transform:translateY(0px)\n        }\n        28%{\n        -webkit-transform:translateY(-5px)\n        }\n        44%{\n        -webkit-transform:translateY(0px)\n        }\n        }\n        .tidot:nth-child(1){\n        -webkit-animation-delay:200ms;\n        }\n        .tidot:nth-child(2){\n        -webkit-animation-delay:300ms;\n        }\n        .tidot:nth-child(3){\n        -webkit-animation-delay:400ms;\n        }`),GM_addStyle(".big-blue-button:hover {\n            background-color: rgb(1, 68, 134);\n        }"),GM_addStyle('\n        .roland-ui-mods-form-heading {\n            font-weight: bold;\n            font-style: italic;\n            border-bottom: 2px solid #ddd;\n            margin-bottom: 20px;\n            font-size: 15px;\n            padding-bottom: 3px;\n        }\n        .roland-ui-mods-form label{\n            display: block;\n            margin: 0px 0px 15px 0px;\n        }\n        .roland-ui-mods-form label > span{\n            width: 340px;\n            font-weight: bold;\n            float: left;\n            padding-top: 8px;\n            padding-right: 5px;\n        }\n        .roland-ui-mods-form input.roland-ui-mods-input-field,\n        .roland-ui-mods-form .roland-ui-mods-textarea-field {\n            box-sizing: border-box;\n            -webkit-box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            border: 1px solid #C2C2C2;\n            box-shadow: 1px 1px 4px #EBEBEB;\n            -moz-box-shadow: 1px 1px 4px #EBEBEB;\n            -webkit-box-shadow: 1px 1px 4px #EBEBEB;\n            border-radius: 3px;\n            -webkit-border-radius: 3px;\n            -moz-border-radius: 3px;\n            padding: 7px;\n            outline: none;\n        }\n        .roland-ui-mods-form .roland-ui-mods-input-field:focus,\n        .roland-ui-mods-form .roland-ui-mods-textarea-field:focus {\n            border: 1px solid #0C0;\n        }\n        .roland-ui-mods-form .roland-ui-mods-textarea-field{\n            height:300px;\n            width: 100%;\n            margin-top: 10px;\n        }\n        .roland-ui-mods-form input[type="checkbox"] {margin-top: 10px;}')};showWhosLooking=()=>{setTimeout((()=>{this.whosLookingText!=GLOBAL.whosLookingText&&(this.whosLookingText=GLOBAL.whosLookingText),GLOBAL.whosLookingResponse&&(this.whosLookingResponseTimestamp=GLOBAL.whosLookingResponse.timestamp,this.injectWhosLookingIndicator()),this.showWhosLooking()}),1e3)};injectWhosLookingIndicator=()=>{let t=$("div.feedActions.slds-grid");$(".roland-ui-mods-whoslooking-indicator").remove();for(let e in GLOBAL.whosLookingResponse.response){let n=GLOBAL.whosLookingResponse.response[e],o=~~(Date.now()/1e3)-~~(n.lastActivityTimestamp/1e3),s=100,i=300,a=1-.8*(o/s<1?o/s:1);t.prepend(this.whosLookingIndicatorTemplate({title:`${n.name} was active on this case ${o}s ago`,initials:this.nameToInitials(n.name),opacity:a,show:!(i<o),isTyping:Date.now()-n.lastKeypressTimestamp<5e3,backgroundColor:n.backgroundColor}))}};nameToInitials=t=>{let e=t.split(" "),n="";for(let t in e)n+=e[t].charAt(0);return n.toUpperCase()};setUserName=t=>{this.userName=t,this.injectSettingsButton(),this.showWhosLooking()};whosLookingIndicatorTemplate=t=>t.show?`<div class='roland-ui-mods-whoslooking-indicator' style='opacity: ${t.opacity}; background-color: ${t.backgroundColor}' title='${t.title}'>\n        <div>${t.initials}</div>\n           <div class="ticontainer ${t.isTyping?"":"roland-hide"}">\n               <div class="tiblock">\n                   <div class="tidot"></div>\n                   <div class="tidot"></div>\n                   <div class="tidot"></div>\n               </div>\n           </div>\n       </div>`:"";settingsButtonTemplate=()=>"<div class=\"big-blue-button\" id='roland-ui-mods-settings-button'>Service Cloud Premium</div>";headerButtonsTemplate=()=>`<div id="roland-ui-mods-header-buttons">${this.settingsButtonTemplate()}</div>`;settingsMenuTemplate=()=>`<div class="roland-ui-mods-form">\n        <div class="roland-ui-mods-form-heading">Settings</div>\n        <form>\n          <label><span>Avatar color</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="avatarColor" id="avatar-color-input" value="${GLOBAL.settingsManager.settings.avatarColor}"/></label>\n          <label><span>Scrollbar width</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="scrollbarWidth" id="scrollbar-width-input" value="${GLOBAL.settingsManager.settings.scrollbarWidth}"/></label>\n          <label><span>Auto-click "Internal Only"</span><input class="roland-ui-mods-settings-input" data-id="autoClickInternalUpdatesTab" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.autoClickInternalUpdatesTab)?"checked":""}/></label>\n          <label><span>Disable list refresh (Bobby's meeting mode)</span><input class="roland-ui-mods-settings-input" data-id="disableListRefresh" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.disableListRefresh)?"checked":""}/></label>\n          <label><span>List refresh rate (in seconds)</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="listRefreshRate" value="${GLOBAL.settingsManager.settings.listRefreshRate}"/></label>\n          <label><span>Use CTRL+Q to close all tabs</span><input class="roland-ui-mods-settings-input" data-id="closeAllTabsUsingCtrlQ" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.closeAllTabsUsingCtrlQ)?"checked":""}/></label>\n          <label><span>Use CTRL+I to open all images</span><input class="roland-ui-mods-settings-input" data-id="openAllImagesUsingCtrlI" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.openAllImagesUsingCtrlI)?"checked":""}/></label>\n          <label><span>Hyperlink URLs when possible (<span style="text-decoration: underline; color: blue;" title='If you notice issues with links not working, please disable and refresh.'>BETA</span>)</span><input class="roland-ui-mods-settings-input" data-id="allUrlHyperlinkingBeta" type="checkbox" ${JSON.parse(GLOBAL.settingsManager.settings.allUrlHyperlinkingBeta)?"checked":""}/></label>\n          <label><span>Support Score red threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssRedThreshold" value="${GLOBAL.settingsManager.settings.ssRedThreshold}"/></label>\n          <label><span>Support Score orange threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssOrangeThreshold" value="${GLOBAL.settingsManager.settings.ssOrangeThreshold}"/></label>\n          <label><span>Support Score yellow threshold</span><input type="text" class="roland-ui-mods-input-field roland-ui-mods-settings-input" data-id="ssYellowThreshold" value="${GLOBAL.settingsManager.settings.ssYellowThreshold}"/></label>\n          <label><span>Text match styles</span><textarea class="roland-ui-mods-textarea-field  roland-ui-mods-settings-input" data-id="textMatchStyles">${JSON.stringify(JSON.parse(GLOBAL.settingsManager.settings.textMatchStyles),void 0,4)}</textarea></label>\n        </form>\n      </div>`;injectSettingsButton=t=>{$("div.slds-global-header > div:nth-child(1)").length>0?(console.log("header found, injecting button..."),GLOBAL.headerFound=!0,$("div.slds-global-header > div:nth-child(1)").after(this.headerButtonsTemplate())):t?console.log("failed to find the header..."):(console.log("header not found, retrying in 5s..."),setTimeout((()=>{this.injectSettingsButton(!0)}),5e3))};uiEvents=()=>{$(document).ready((()=>{$(document).off("click","#roland-ui-mods-settings-button").on("click","#roland-ui-mods-settings-button",(t=>{this.settingsButtonClicked(t)})),document.addEventListener("mousemove",this.saveMouseMovementTime,!1),document.addEventListener("keydown",this.saveKeypressTime)})),document.onkeydown=this.keyPress};keyPress=t=>{let e=window.event?event:t;if(81==e.keyCode&&e.ctrlKey&&GLOBAL.settingsManager.settings.closeAllTabsUsingCtrlQ&&this.closeTabs(),73==e.keyCode&&e.ctrlKey&&GLOBAL.settingsManager.settings.openAllImagesUsingCtrlI){let t=$('a[href*="AttachedContentDocuments"] .view-all-label');GLOBAL.fileLinks?this.openImages():t.length>0&&(t.click(),this.waitForFileLinks())}};waitForFileLinks=async()=>{GLOBAL.fileLinks||(GLOBAL.fileLinks=await new Promise((t=>{GLOBAL.imageUrlResolvedCallback=t}))),this.openImages()};tryToFindFileLinks=()=>{console.log("trying to find links");let t=$("a:not('.tabHeader')[href*=\"/ContentDocument/\"] span.itemTitle.desktop");t.length>0&&(GLOBAL.fileLinks=t),console.log(t)};openImages=async()=>{GLOBAL.attachedImageUrls=[];let t=[];GLOBAL.fileLinks.each(((e,n)=>{t.push(n)}));for(let e in t){t[e].click(),await new Promise((t=>{GLOBAL.imageUrlResolvedCallback=t})),$('div.forceContentBasePreviewToolbar button[title="Close"]').click()}let e=this.addImagesToDiv(GLOBAL.imageContainerDiv,GLOBAL.attachedImageUrls);this.showImagePopup(e)};showImagePopup=t=>{let e={title:"Images",content:`<div style="padding: 15px;text-align:center;">${t}</div>`,buttons:{Close:{handler:null}},keyEvents:{13:{handler:null},27:{handler:null}},dim:!0,expandStepDuration:500,collapseStepDuration:300,expandCallback:null,collapseCallback:this.closeFilesTab},n=new Popup(e);n.keyEvents[13].handler=n.collapse,n.keyEvents[27].handler=n.collapse,n.buttons.Close.handler=n.collapse,$("body").append('<div id="roland-ui-mods-image-viewer-popup" style="padding:5px;position:fixed;width:90%;height:90%;top:5%;left:5%;z-index:9000;"></div>'),n.render("roland-ui-mods-image-viewer-popup"),n.expand()};closeFilesTab=()=>{GLOBAL.fileTabCloseButton&&GLOBAL.fileTabCloseButton.click(),console.log("close")};addImagesToDiv=(t,e)=>{let n="";for(let t in e)n+=`<img style="border: 1px solid #333;" src='${e[t]}'><br><br>`;return t.html(n),this.styleDiv(t),n};styleDiv=t=>{t.css({display:"block",overflow:"scroll","text-align":"center",padding:"100px"})};closeTabs=()=>{let t=$('button.slds-button.slds-button_icon.slds-button_icon-x-small.slds-button_icon-container[title^="Close "]');t.length>0&&t.click()};toggleWidenModeButtonClicked=()=>{console.log("toggle");let t=$('a:contains("Contact Details")');this.toggleOffsetAncestor(t,"[id^='leftColumn-']")};toggleOffsetAncestor=(t,e)=>(console.log(t),t.is(e)?(console.log("toggling"),t.hide(),t.next().css("width","100%"),!0):t.offsetParent().length>0?(console.log("looking deeper"),this.toggleOffsetAncestor(t.offsetParent(),e)):(console.log("fail"),!1));saveMouseMovementTime=()=>{GLOBAL.mouseMovedOn=Date.now()};saveKeypressTime=()=>{GLOBAL.keyPressedOn=Date.now()};settingsButtonClicked=t=>{let e={title:`Service Cloud Premium ${GLOBAL.version}`,content:`<div style="padding: 15px;">${this.settingsMenuTemplate()}</div>`,buttons:{Cancel:{handler:null},Save:{handler:null}},keyEvents:{13:{handler:null},27:{handler:null}},dim:!0,expandStepDuration:500,collapseStepDuration:300,expandCallback:null,collapseCallback:null},n=new Popup(e);n.keyEvents[27].handler=n.collapse,n.buttons.Save.handler=partial(this.saved,n.collapse),$("body").append('<div id="roland-ui-mods-settings-popup" style="padding:5px;position:fixed;width:70%;height:70%;top:15%;left:15%;z-index:9000;"></div>'),n.render("roland-ui-mods-settings-popup"),n.expand(t)};saved=t=>{let e;$(".roland-ui-mods-settings-input").each(((t,n)=>{let o,s=$(n),i=s.attr("data-id");s.is('input[type="text"]')?o=s.val():s.is('input[type="checkbox"]')?o=s.is(":checked"):s.is("textarea")&&(o=s.val()),e=GLOBAL.settingsManager.update(i,o)})),t()}}const GLOBAL={totalTimeSpentInRolandUImodsScript:0,totalTimeSpent:0,mutationObserverRegistry:null,activeCaseNumber:null,activeCaseId:null,activeCaseElementToHighlight:null,caseIdNumberPairs:{},activeCaseStatus:null,userName:null,profileButton:null,pathname:window.location.pathname,mouseMovedOn:null,keyPressedOn:null,headerFound:!1,imageOpenerButtonsList:{},attachedImageUrls:[],imageUrlResolvedCallback:null,imageContainerDiv:null,fileLinks:null,fileTabCloseButton:null,version:"v20220721.2"},rolandUImods=()=>{console.log("Service Cloud Premium version:",GLOBAL.version),GLOBAL.settingsManager=new SettingsManager,GLOBAL.mutationObserverRegistry=new MutationObserverRegistry("Global"),GLOBAL.mutationObserverRegistry.observer.observe(document.body,{subtree:!0,childList:!0,attributes:!0,characterData:!0}),GLOBAL.conditionalFormatting=new ConditionalFormatting,GLOBAL.uiInjector=new UIinjector,GLOBAL.conditionalFormatting.run(),GLOBAL.mutationObserverRegistry.addFunctionForNodeAddition(detectUserName),exposeUserName();(new WhosLooking).check(),overrideListRefreshRate(),refreshLists()},overrideListRefreshRate=()=>{setTimeout((()=>{refreshListsInSeconds?refreshListsInSeconds=2e6:overrideListRefreshRate()}),1e3)},refreshLists=()=>{isNaN(parseFloat(GLOBAL.settingsManager.settings.listRefreshRate))||setTimeout((()=>{if(!GLOBAL.settingsManager.settings.disableListRefresh){let t=$($("button",$("force-list-view-manager-button-bar"))[0]);t.length>0&&t.click()}refreshLists()}),1e3*parseFloat(GLOBAL.settingsManager.settings.listRefreshRate))};function partial(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.concat(Array.prototype.slice.call(arguments));return t.apply(this,n)}}const detectUserName=t=>{const e=$(t).find("h1.profile-card-name a");e.length>0&&null!=GLOBAL.profileButton&&null==GLOBAL.settingsManager.settings.userName&&(GLOBAL.settingsManager.update("userName",e.html()),GLOBAL.uiInjector.setUserName(GLOBAL.settingsManager.settings.userName),setTimeout((()=>{GLOBAL.profileButton.click()}),100))},exposeUserName=()=>{if(null==GLOBAL.settingsManager.settings.userName){const t=$("button.branding-userProfile-button");t.length>0?(GLOBAL.profileButton=t.get(0),tryOpeningProfilePopupToLookForName()):setTimeout((()=>{exposeUserName()}),15e3)}else GLOBAL.uiInjector.setUserName(GLOBAL.settingsManager.settings.userName)},tryOpeningProfilePopupToLookForName=()=>{null==GLOBAL.settingsManager.settings.userName&&(GLOBAL.profileButton.click(),setTimeout((()=>{0==$("h1.profile-card-name").length&&tryOpeningProfilePopupToLookForName()}),15e3))};rolandUImods();var templateHTML='<div>\n    <div>\n      <br />\n    </div>Best Regards,\n    <br />{{{Sender.FirstName}}} {{{Sender.LastName}}}\n    <br />{{{Sender.Title}}}\n    <br />\n    <br />\n    <table border="0" cellpadding="0" cellspacing="0" style="border-collapse:collapse;font-size: 13px;" width=""\n    class=" cke_show_border">\n      <tbody>\n        <tr style="">\n          <td nowrap="nowrap" style=" width: 120px;">\n            <span style="">Account:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Account}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Case Contact:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Recipient.Name}}}</span>\n          </td>\n        </tr>\n        <tr>\n          <td nowrap="nowrap" style="">\n            <span style="">Case #:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <a data-cke-saved-href="https://support.planview.com/s/case/{{{Case.Id}}}"\n            href="https://support.planview.com/s/case/{{{Case.Id}}}">{{{Case.CaseNumber}}}</a>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Created Date:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.CreatedDate}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Type:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Type}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Product Line:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Product_Line__c}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Capability:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Product_Capability__c}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Priority:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Priority__c}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Severity:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Severity__c}}}</span>\n          </td>\n        </tr>\n        <tr style="">\n          <td nowrap="nowrap" style="">\n            <span style="">Subject:</span>\n          </td>\n          <td nowrap="nowrap" style="">\n            <span style="">{{{Case.Subject_text__c}}}</span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <br />\n    <br />\n    <span style="font-size:10px;">Connect to expertise and support for your Planview solution!\n    <br />\n    <a data-cke-saved-href="https://success.planview.com/" href="https://success.planview.com/">Customer Success Center</a> has\n    E-Learning, best practices, networking and more.\n    <br />\n    <a data-cke-saved-href="https://support.planview.com/" href="https://support.planview.com/">Customer Care Community</a> is your\n    new one-stop-shop for all support needs.</span>\n    <br />\n    <br />\n    <br /></div>',scriptName="Service Cloud Premium",pageHref=window.location.href,refreshListsInSeconds=60,lookupInterval=500,maxMailEditorLookups=20,currentMailEditorLookup=0,maxShowMoreButtonLookups=20,currentShowMoreButtonLookup=0,maxExpandButtonLookups=20,currentExpandButtonLookup=0;function makeJIRAClickablePVE(t){var e=t[0];setTimeout((function(){var t=jQuery(e).html();const n=ArrNoDupe(t.match(/PVE-\d+/g));jQuery.each(n,(function(e,n){t=t.replace(n,'<a href="https://jira.planview.com/browse/'+n+'" target="_blank">'+n+"</a>")})),jQuery(e).html(t)}),1500)}function makeJIRAClickableREQ(t){var e=t[0];setTimeout((function(){var t=jQuery(e).html();const n=ArrNoDupe(t.match(/REQ-\d+/g));jQuery.each(n,(function(e,n){t=t.replace(n,'<a href="https://jira.planview.com/browse/'+n+'" target="_blank">'+n+"</a>")})),jQuery(e).html(t)}),1500)}function makeJIRAClickableTROUX(t){var e=t[0];setTimeout((function(){var t=jQuery(e).html();const n=ArrNoDupe(t.match(/TROUX-\d+/g));jQuery.each(n,(function(e,n){t=t.replace(n,'<a href="https://jira.planview.com/browse/'+n+'" target="_blank">'+n+"</a>")})),jQuery(e).html(t)}),1500)}function clickViewMoreButton(t){var e=t[0];console.log(e),setTimeout((function(){console.log(scriptName+": Clicking 'View More' button"),e.click()}),1e3)}function clickExpandButton(t){var e=t[0];console.log(e),setTimeout((function(){console.log(scriptName+": Clicking 'Expand' button"),e.click()}),2e3)}function clickRefreshButton(t){var e=$($("button",$("force-list-view-manager-button-bar"))[0]);"refreshButton"==$(e).attr("name")&&setTimeout((function(){console.log(scriptName+": Clicking 'Refresh' button"),e.click(),clickRefreshButton(t)}),1e3*refreshListsInSeconds)}function createSeverityObserver(t){console.log(scriptName+": Creating severity observer"),highlightCaseSeverity(t);new MutationObserver((function(e){console.log(scriptName+": Table updated"),highlightCaseSeverity(t)})).observe(t[0],{attributes:!0,childList:!0,characterData:!0})}function highlightCaseSeverity(t){setTimeout((function(){var e=$(t).find("thead tr");0==e.length&&(console.log(scriptName+": THEAD not found, using first row of TBODY"),e=$(t).find("tbody tr:nth-child(1)")),console.log(scriptName+": Highlighting case severity");var n=0,o=-1;e.children().each((function(){jQuery(this)[0].textContent.includes("Severity")&&(o=n+1,console.log(scriptName+": severityColumnIndex: "+o)),n++}));var s=0,i=-1;e.children().each((function(){jQuery(this)[0].textContent.includes("Status")&&(i=s+1,console.log(scriptName+": statusColumnIndex: "+i)),s++})),$(t).find("tbody tr td:nth-child("+o+")").each((function(){var t=jQuery(this)[0],e=jQuery(this).parent().find("td:nth-child("+i+")")[0].textContent;["Pending Release","In Development"].includes(e)||(t.textContent.includes("Major")?$(t).css("background-color","#FF6D00"):t.textContent.includes("Critical")&&$(t).css("background-color","#D50000"))}))}),1e3)}function clickCaseDescriptionShowMoreButton(t){var e=t[0];setTimeout((function(){console.log(scriptName+": Clicking 'Show More' button to expand Case Description"),e.click()}),1e3)}function extendChildCaseTextBox(t){var e=t[0];setTimeout((function(){console.log(scriptName+": Extending textbox of child case form"),jQuery(e).css("height","500px")}),1e3)}function extendEmailTextBox(t){var e=t[0];console.log(e),setTimeout((function(){console.log(scriptName+": Extending textbox of email form"),jQuery(e).css("height","500px")}),1e3)}function extendEmailIFrame(t){var e=t[0];console.log(e),setTimeout((function(){console.log(scriptName+": Extending iframe of email editor"),jQuery(e).css("height","582px")}),1e3)}function removeTruncateClassFromPosts(t){console.log(scriptName+": Showing complete posts and hiding 'Show More' links in posts"),t.each((function(){var t=jQuery(this)[0],e=jQuery(t).parent().find("a.cuf-more:not(.hidden)")[0];jQuery(e).hide(),jQuery(t).removeClass("feedBodyInnerTruncated")}))}function addObserverIfDesiredNodeAvailable(){var t=jQuery("div.tabset")[0];if(!t)return console.log("waiting..."),void window.setTimeout(addObserverIfDesiredNodeAvailable,lookupInterval);new MutationObserver((function(t){t.map((function(t){t.type;t.target,jQuery(t.target).find("span").each((function(){var t=jQuery(this).html();t.match(/PVE-/gi);t.includes("PVE-")&&(console.log(t),t=t.replace("PVE-",'<a href="">test</a>'),jQuery(this).html(t))}))}))})).observe(t,{childList:!0,subtree:!0})}function clickShowMoreButtonIfAvailable(){if(currentShowMoreButtonLookup>=maxShowMoreButtonLookups)console.log(scriptName+": Show More button not found after "+maxShowMoreButtonLookups+" tries. Giving up now :(");else{if(currentShowMoreButtonLookup++,!jQuery("button.uiButton.cuf-showMore")[0])return console.log(scriptName+": Looking for show more button..."),void window.setTimeout(clickShowMoreButtonIfAvailable,lookupInterval);console.log(scriptName+": Clicking show more button..."),jQuery(".uiButton.cuf-showMore")[0].click()}}function clickExpandButtonIfAvailable(){if(currentExpandButtonLookup>=maxExpandButtonLookups)console.log(scriptName+": Expand button not found after "+maxExpandButtonLookups+" tries. Giving up now :(");else{currentExpandButtonLookup++;var t=jQuery('button.uiButton[title="Expand all visible posts"]')[0];if(!t)return console.log(scriptName+": Looking for expand button..."),void window.setTimeout(clickExpandButtonIfAvailable,lookupInterval);console.log(scriptName+": Clicking expand button..."),console.log(t),jQuery('button.uiButton[title="Expand all visible posts"]')[0].click()}}function addTemplateIfEditorAvailable(){if(currentMailEditorLookup>=maxMailEditorLookups)console.log(scriptName+": Editor iFrame not found after "+maxMailEditorLookups+" tries. Giving up now :(");else{currentMailEditorLookup++;var t=jQuery("iframe")[0];if(!t)return console.log(scriptName+": Editor iFrame not found - Looking again..."),void window.setTimeout(addTemplateIfEditorAvailable,lookupInterval);if(0==t.contentWindow.document.children.length)return console.log(scriptName+": Editor not fully loaded - Trying again..."),void window.setTimeout(addTemplateIfEditorAvailable,lookupInterval);if(0==t.contentWindow.document.children[0].children.length)return console.log(scriptName+": Editor not fully loaded - Trying again..."),void window.setTimeout(addTemplateIfEditorAvailable,lookupInterval);console.log(scriptName+": Editor iFrame found! - Adding template...");var e=jQuery("iframe")[0].contentWindow.document.children[0].children[1];e.appendChild(htmlToElement(templateHTML)),setTimeout((function(){e.focus()}),lookupInterval),console.log(scriptName+": Finished")}}function htmlToElement(t){var e=document.createElement("template");return t=t.trim(),e.innerHTML=t,e.content.firstChild}function ArrNoDupe(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)}!function(){"use strict";jQuery((function(){if(console.log("Service Cloud Premium: Loaded for page: "+pageHref),pageHref.indexOf("https://planview.my.salesforce.com/email/htmlbody/htmlbody.jsp")>-1)waitForKeyElements("#cke_1_contents",extendEmailTextBox);else if(pageHref.indexOf("https://planview.lightning.force.com/lightning/")>-1){waitForKeyElements('span.uiOutputText:contains("PVE-")',makeJIRAClickablePVE),waitForKeyElements('span.uiOutputText:contains("REQ-")',makeJIRAClickableREQ),waitForKeyElements('span.uiOutputText:contains("TROUX-")',makeJIRAClickableTROUX),waitForKeyElements("div.feedBodyInnerTruncated",removeTruncateClassFromPosts),waitForKeyElements("force-list-view-manager-button-bar",clickRefreshButton),waitForKeyElements(".slds-table",createSeverityObserver);var t="iframe.reportsReportBuilder";waitForKeyElements(t,(()=>{console.log("iframe found, waiting until loaded..."),$(t).on("load",(function(){console.log("iframe finished loading"),setTimeout((function(){console.log("wait for report to load"),waitForKeyElements(".data-grid-full-table",createSeverityObserver,!0,t)}),2e3)}))}));var e='iframe[title="dashboard"]';waitForKeyElements(e,(()=>{console.log("iframe found, waiting until loaded..."),$(e).on("load",(function(){console.log("iframe finished loading"),setTimeout((function(){console.log("wait for dashboard to load"),waitForKeyElements(".data-grid-full-table",createSeverityObserver,!0,e)}),3e3)}))})),waitForKeyElements('button.uiButton.pa-drawer-toggle[title="Show More"]',clickCaseDescriptionShowMoreButton),waitForKeyElements(".forceChatterPublisherQuickAction .activeState textarea",extendChildCaseTextBox),waitForKeyElements('iframe[title="CK Editor Container"]',extendEmailIFrame)}}))}();